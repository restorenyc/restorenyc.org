!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof module&&module.exports?require("jquery"):jQuery)}(function(e){function t(t){var i={},a=/^jQuery\d+$/;return e.each(t.attributes,function(e,t){t.specified&&!a.test(t.name)&&(i[t.name]=t.value)}),i}function i(t,i){var a=this,n=e(this);if(a.value===n.attr(s?"placeholder-x":"placeholder")&&n.hasClass(f.customClass))if(a.value="",n.removeClass(f.customClass),n.data("placeholder-password")){if(n=n.hide().nextAll('input[type="password"]:first').show().attr("id",n.removeAttr("id").data("placeholder-id")),t===!0)return n[0].value=i,i;n.focus()}else a==o()&&a.select()}function a(a){var o,n=this,l=e(this),r=n.id;if(!a||"blur"!==a.type||!l.hasClass(f.customClass))if(""===n.value){if("password"===n.type){if(!l.data("placeholder-textinput")){try{o=l.clone().prop({type:"text"})}catch(i){o=e("<input>").attr(e.extend(t(this),{type:"text"}))}o.removeAttr("name").data({"placeholder-enabled":!0,"placeholder-password":l,"placeholder-id":r}).bind("focus.placeholder",i),l.data({"placeholder-textinput":o,"placeholder-id":r}).before(o)}n.value="",l=l.removeAttr("id").hide().prevAll('input[type="text"]:first').attr("id",l.data("placeholder-id")).show()}else{var c=l.data("placeholder-password");c&&(c[0].value="",l.attr("id",l.data("placeholder-id")).show().nextAll('input[type="password"]:last').hide().removeAttr("id"))}l.addClass(f.customClass),l[0].value=l.attr(s?"placeholder-x":"placeholder")}else l.removeClass(f.customClass)}function o(){try{return document.activeElement}catch(e){}}var n,l,s=!1,r="[object OperaMini]"===Object.prototype.toString.call(window.operamini),c="placeholder"in document.createElement("input")&&!r&&!s,d="placeholder"in document.createElement("textarea")&&!r&&!s,u=e.valHooks,h=e.propHooks,f={};c&&d?(l=e.fn.placeholder=function(){return this},l.input=!0,l.textarea=!0):(l=e.fn.placeholder=function(t){var o={customClass:"placeholder"};return f=e.extend({},o,t),this.filter((c?"textarea":":input")+"["+(s?"placeholder-x":"placeholder")+"]").not("."+f.customClass).not(":radio, :checkbox, [type=hidden]").bind({"focus.placeholder":i,"blur.placeholder":a}).data("placeholder-enabled",!0).trigger("blur.placeholder")},l.input=c,l.textarea=d,n={get:function(t){var i=e(t),a=i.data("placeholder-password");return a?a[0].value:i.data("placeholder-enabled")&&i.hasClass(f.customClass)?"":t.value},set:function(t,n){var l,s,r=e(t);return""!==n&&(l=r.data("placeholder-textinput"),s=r.data("placeholder-password"),l?(i.call(l[0],!0,n)||(t.value=n),l[0].value=n):s&&(i.call(t,!0,n)||(s[0].value=n),t.value=n)),r.data("placeholder-enabled")?(""===n?(t.value=n,t!=o()&&a.call(t)):(r.hasClass(f.customClass)&&i.call(t),t.value=n),r):(t.value=n,r)}},c||(u.input=n,h.value=n),d||(u.textarea=n,h.value=n),e(function(){e(document).delegate("form","submit.placeholder",function(){var t=e("."+f.customClass,this).each(function(){i.call(this,!0,"")});setTimeout(function(){t.each(a)},10)})}),e(window).bind("beforeunload.placeholder",function(){var t=!0;try{"javascript:void(0)"===document.activeElement.toString()&&(t=!1)}catch(e){}t&&e("."+f.customClass).each(function(){this.value=""})}))});var Utils=function(){return $(document).ready(function(){Utils.init()}),{$html:$("html"),$body:$("body"),$main:$("#main"),$mh:$(".mh"),$nav:$("#site-nav"),$lb:$("#lightbox"),gaLoaded:!1,init:function(){Utils.removeBgVideo(),Utils.isLegacyIE()&&$("input, textarea").placeholder(),Utils.mailchimp(),Utils.campaign()},isLegacyIE:function(){return Utils.$html.hasClass("ie8")||Utils.$html.hasClass("ie9")},isMobile:function(){var e=navigator.userAgent,t=/Android|iPhone|iPad|PlayBook|Mobile|IEMobile/i;return t.test(e)},isHome:function(){return Utils.$body.hasClass("home")},removeBgVideo:function(){Utils.isMobile()&&$(".bg-video").remove()},lightbox:function(e,t){var i=Utils.$lb.find(".wrap"),a=Utils.$lb.find(".content");"on"===e?(a.empty(),a.html(t),Utils.$lb.addClass("open"),i.on("click.lbOpen",function(){Utils.$body.hasClass("nav-open")&&Utils.$mh.find(".menu-btn").trigger("click")})):(a.empty(),Utils.$lb.removeClass("open"),i.off("click.lbOpen"))},mailchimp:function(){var e=$(".signup-form, .subscribe-module"),t="http://restorenyc.us13.list-manage.com/subscribe?u=3ab98ba41ef52e8a3ed2e0745&id=5360afa171&MERGE0=";e.length&&e.each(function(){var e=$(this),i=e.find(".email-submit");i.click(function(i){i.preventDefault(),window.location.href=t+e.find(".email").val()})})},campaign:function(){function e(e){return e.indexOf("?")>-1?"&":"?"}var t=$(".campaign-support, .donate-module");t.length&&t.each(function(){var t=$(this).find(".donate-action"),i=t.attr("href"),a=$(this).find(".donate-amount"),o=$(this).find(".monthly"),n=o.find("input"),l=$(this).find(".check strong"),s=$(this).find(".check-address"),r=null;o.on("click",function(e){console.log("c"),"0"===n.val()?(n.val("1"),o.find(".checkbox-off").removeClass("show"),o.find(".checkbox-on").addClass("show")):(n.val("0"),o.find(".checkbox-off").addClass("show"),o.find(".checkbox-on").removeClass("show")),a.trigger("keyup")}),a.on("keyup",function(l){l.preventDefault(),r=i+e(i)+"amount="+a.val(),o.length&&(r=r+e(r)+"recurring="+n.val()),t.attr("href",r)}),l.on("click",function(){s.toggleClass("show")}),a.trigger("keyup")})}}}(jQuery);!function(e){var t={trackOpen:!0,init:function(){this.bindEvents()},closeNav:function(){Utils.lightbox("off"),this.closeSubmenu(),Utils.$body.removeClass("nav-open")},closeSubmenu:function(){Utils.$nav.find(".item.open").removeClass("open")},bindEvents:function(){var i=this;Utils.$body.on("click",".menu-btn, .menu-close",function(t){Utils.$body.hasClass("nav-open")?i.closeNav():(Utils.lightbox("on"),Utils.$body.addClass("nav-open"),e(window).on("resize.nav",window,function(t){this.outerWidth>1024&&(i.closeNav(),e(window).off("resize.nav"))}))}).on("click","#site-nav .close",function(e){Utils.lightbox("off"),Utils.$body.removeClass("nav-open")}).on("click","#site-nav .has-sub",function(i){var a=e(i.target).closest(".item");a.parent(".subitem").length<1&&(a.hasClass("open")?t.closeSubmenu():(t.closeSubmenu(),a.addClass("open")))})}};e(document).ready(function(){t.init()})}(jQuery),function(e){var t={el:null,init:function(){this.el=e(Utils.isHome()?".banner-lead":".single-header"),this.loadHeaderImage(),this.loadVideo()},loadHeaderImage:function(){if(this.el.length>0&&(Utils.isHome()||this.el.hasClass("bg-image")||this.el.hasClass("bg-image-blog"))){var t=this.el.find(".portrait");url=t.attr("data-img-url"),position=""===e.trim(t.attr("data-img-pos"))?"50% 50%":t.attr("data-img-pos"),img=new Image,console.log(url),img.addEventListener("load",function(){t.css({"background-image":"url("+url+")","background-position":position}).addClass("loaded").closest("section").addClass("ready")}),img.src=url}},loadVideo:function(){var t,i,a=e(".banner-lead"),o=a.find("video");!Utils.isLegacyIE()&&!Utils.isMobile()&&a.length>0&&o.length>0?(i=o.attr("data-src"),t=i.substr(i.lastIndexOf(".")+1),o.on("loadstart",function(){o.addClass("loaded")}),o.attr("src",i)):a.addClass("no-video")}};e(document).ready(function(){t.init()})}(jQuery),function(e){var t={el:null,init:function(){this.el=e("#hero"),this.el.length>0&&(this.loadHeaderImage(),this.loadVideo(),this.bindClickEvents())},isMobileVP:function(){return this.getViewport().width<1024},loadHeaderImage:function(){if(this.el.length>0&&this.el.hasClass("hero-bg-image")){var t=this.el.find(".portrait");url=t.attr("data-img-url"),position=""===e.trim(t.attr("data-img-pos"))?"50% 50%":t.attr("data-img-pos"),img=new Image,img.addEventListener("load",function(){t.css({"background-image":"url("+url+")","background-position":position}).addClass("loaded").closest("section").addClass("ready")}),img.src=url}},loadVideo:function(){var t,i,a=e("#hero"),o=a.find("video");!Utils.isLegacyIE()&&!Utils.isMobile()&&a.length>0&&o.length>0?(i=o.attr("data-src"),t=i.substr(i.lastIndexOf(".")+1),o.on("loadstart",function(){o.addClass("loaded")}),o.attr("src",i)):a.addClass("no-video")},getViewport:function(){var e=window,t="inner";return"innerWidth"in window||(t="client",e=document.documentElement||document.body),{width:e[t+"Width"],height:e[t+"Height"]}},fixPosition:function(){var t=(this.getViewport().width,this.getViewport().height);this.isMobileVP()?(e("#hero").css("margin-bottom",0),Utils.$main.css("opacity",1),Utils.$main.removeClass("locked")):(Utils.$main.addClass("locked"),e("#hero").css("margin-bottom",t))},bindEvents:function(){e(window).on("scroll",function(){var t=this.getViewport().height,i=Utils.$main.height(),a=window.scrollY,o=a/t,n=o<.35?.35:o<1?o:1;this.isMobileVP()||(a>t-5?(console.log("if"),Utils.$main.css("opacity",1),e("#hero").css("margin-bottom",0),Utils.$main.removeClass("locked")):(console.log("else"),Utils.$main.css("opacity",n),e("#hero").css("margin-bottom",t+i),Utils.$main.addClass("locked")))}.bind(this)),e(window).on("resize",function(){this.fixPosition(),e("html, body").scrollTop(0)}.bind(this))},bindClickEvents:function(){e(".nav-down").click(function(){var t=Utils.$mh,i=t.height();return e("html, body").animate({scrollTop:this.getViewport().height-i},600),!1}.bind(this))}};e(document).ready(function(){t.init()})}(jQuery);var Billboard=function(e){return e(function(){Billboard.init()}),{time:3,limit:12,timers:[],isWrapped:!0,vimeo:{regex:"vimeo.com/video/",baseUrl:"https://player.vimeo.com/video/",queryVar:"?badge=0&title=0&byline=0&rel=0&autoplay=1",attr:{frameborder:"0",webkitallowfullscreen:"true",mozallowfullscreen:"true",allowfullscreen:"true"}},youtube:{regex:"youtu.be/",baseUrl:"https://www.youtube.com/embed/",queryVar:"?autoplay=1",attr:{frameborder:"0",allowfullscreen:"true"}},init:function(){this.collection=Utils.$body.find(".billboard"),this.collection.length&&this.bindEvents()},addVideo:function(e){var t;return e.indexOf(this.vimeo.regex)>-1?(t=e.split(this.vimeo.regex)[1],this.createIframe("vimeo",t)):e.indexOf(this.youtube.regex)>-1?(t=e.split(this.youtube.regex)[1],this.createIframe("youtube",t)):void 0},createIframe:function(t,i){var a=e("<iframe></iframe>").clone(),o=this[t],n=o.baseUrl+i+o.queryVar;return a.attr("src",n),e.each(o.attr,function(e,t){a.attr(e,t)}),a},startTimer:function(e){var t=this,i=1;this.timers[e]=setInterval(function(){i<t.limit?(t.collection.eq(e).find(".slider-billboard").flickity("next",t.isWrapped),i++):t.stopTimer(e)},1e3*this.time)},stopTimer:function(e){clearInterval(this.timers[e])},bindEvents:function(){var t=this;this.collection.each(function(i,a){function o(){d.filter(".is-selected").removeClass("is-selected"),d.eq(r.selectedIndex).addClass("is-selected"),n()}function n(){var e=c.find("ul"),t=d.filter(".is-selected"),i=(t.width(),t.position().left),a=(.5*window.screen.width,e.scrollLeft()),o=a>i?i+a:i;e.animate({scrollLeft:o},1e3)}var l=e(a).find(".gallery-cell"),s=e(a).find(".slider-billboard").flickity({pageDots:!1,wrapAround:!0}),r=s.data("flickity"),c=e(a).find("nav"),d=c.find("li");s.on("cellSelect",function(){o()}),s.on("click.timer",".flickity-prev-next-button",function(){t.stopTimer(i),s.off("click.timer")}),s.on("staticClick.timer, dragStart.timer",function(){t.stopTimer(i),s.off("staticClick.timer, dragStart.timer")}),c.on("click","li",function(){var a=e(this).index();s.flickity("select",a),t.stopTimer(i)}),o(),l.length>1&&(l.each(function(i,a){var o=e(a).attr("data-video");if(o&&""!==o){var n=t.addVideo(o);e(a).addClass("video").on("click",".image-wrap",function(){e(a).addClass("play"),e(a).find(".video-wrap").html(n)})}}),t.startTimer(i))})}}}(jQuery),Video=function(e){return e(function(){Video.init()}),{vimeo:{regex:"vimeo.com/video/",baseUrl:"https://player.vimeo.com/video/",queryVar:"?badge=0&title=0&byline=0&rel=0&autoplay=1",attr:{frameborder:"0",webkitallowfullscreen:"true",mozallowfullscreen:"true",allowfullscreen:"true"}},youtube:{regex:"youtu.be/",baseUrl:"https://www.youtube.com/embed/",queryVar:"?autoplay=1",attr:{frameborder:"0",allowfullscreen:"true"}},init:function(){this.videoSections=Utils.$body.find(".sec-video"),this.videoSections.length&&this.bindEvents()},addVideo:function(e){var t;return e.indexOf(this.vimeo.regex)>-1?(t=e.split(this.vimeo.regex)[1],this.createIframe("vimeo",t)):e.indexOf(this.youtube.regex)>-1?(t=e.split(this.youtube.regex)[1],this.createIframe("youtube",t)):void 0},createIframe:function(t,i){var a=e("<iframe></iframe>").clone(),o=this[t],n=o.baseUrl+i+o.queryVar;return a.attr("src",n),e.each(o.attr,function(e,t){a.attr(e,t)}),a},bindEvents:function(){this.videoSections.each(function(t,i){var a=e(i).attr("data-video");a&&""!==a&&e(i).on("click",".image-wrap",function(){if(window.lity){lity(a)}})})}}}(jQuery);