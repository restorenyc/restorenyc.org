!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof module&&module.exports?require("jquery"):jQuery)}(function(e){function t(t){var i={},n=/^jQuery\d+$/;return e.each(t.attributes,function(e,t){t.specified&&!n.test(t.name)&&(i[t.name]=t.value)}),i}function i(t,i){var n=this,a=e(this);if(n.value===a.attr(s?"placeholder-x":"placeholder")&&a.hasClass(f.customClass))if(n.value="",a.removeClass(f.customClass),a.data("placeholder-password")){if(a=a.hide().nextAll('input[type="password"]:first').show().attr("id",a.removeAttr("id").data("placeholder-id")),t===!0)return a[0].value=i,i;a.focus()}else n==o()&&n.select()}function n(n){var o,a=this,l=e(this),r=a.id;if(!n||"blur"!==n.type||!l.hasClass(f.customClass))if(""===a.value){if("password"===a.type){if(!l.data("placeholder-textinput")){try{o=l.clone().prop({type:"text"})}catch(i){o=e("<input>").attr(e.extend(t(this),{type:"text"}))}o.removeAttr("name").data({"placeholder-enabled":!0,"placeholder-password":l,"placeholder-id":r}).bind("focus.placeholder",i),l.data({"placeholder-textinput":o,"placeholder-id":r}).before(o)}a.value="",l=l.removeAttr("id").hide().prevAll('input[type="text"]:first').attr("id",l.data("placeholder-id")).show()}else{var c=l.data("placeholder-password");c&&(c[0].value="",l.attr("id",l.data("placeholder-id")).show().nextAll('input[type="password"]:last').hide().removeAttr("id"))}l.addClass(f.customClass),l[0].value=l.attr(s?"placeholder-x":"placeholder")}else l.removeClass(f.customClass)}function o(){try{return document.activeElement}catch(e){}}var a,l,s=!1,r="[object OperaMini]"===Object.prototype.toString.call(window.operamini),c="placeholder"in document.createElement("input")&&!r&&!s,d="placeholder"in document.createElement("textarea")&&!r&&!s,u=e.valHooks,h=e.propHooks,f={};c&&d?(l=e.fn.placeholder=function(){return this},l.input=!0,l.textarea=!0):(l=e.fn.placeholder=function(t){var o={customClass:"placeholder"};return f=e.extend({},o,t),this.filter((c?"textarea":":input")+"["+(s?"placeholder-x":"placeholder")+"]").not("."+f.customClass).not(":radio, :checkbox, [type=hidden]").bind({"focus.placeholder":i,"blur.placeholder":n}).data("placeholder-enabled",!0).trigger("blur.placeholder")},l.input=c,l.textarea=d,a={get:function(t){var i=e(t),n=i.data("placeholder-password");return n?n[0].value:i.data("placeholder-enabled")&&i.hasClass(f.customClass)?"":t.value},set:function(t,a){var l,s,r=e(t);return""!==a&&(l=r.data("placeholder-textinput"),s=r.data("placeholder-password"),l?(i.call(l[0],!0,a)||(t.value=a),l[0].value=a):s&&(i.call(t,!0,a)||(s[0].value=a),t.value=a)),r.data("placeholder-enabled")?(""===a?(t.value=a,t!=o()&&n.call(t)):(r.hasClass(f.customClass)&&i.call(t),t.value=a),r):(t.value=a,r)}},c||(u.input=a,h.value=a),d||(u.textarea=a,h.value=a),e(function(){e(document).delegate("form","submit.placeholder",function(){var t=e("."+f.customClass,this).each(function(){i.call(this,!0,"")});setTimeout(function(){t.each(n)},10)})}),e(window).bind("beforeunload.placeholder",function(){var t=!0;try{"javascript:void(0)"===document.activeElement.toString()&&(t=!1)}catch(e){}t&&e("."+f.customClass).each(function(){this.value=""})}))});var Utils=function(){return $(document).ready(function(){Utils.init()}),{$html:$("html"),$body:$("body"),$main:$("#main"),$mh:$(".mh"),$nav:$("#site-nav"),$lb:$("#lightbox"),gaLoaded:!1,init:function(){Utils.removeBgVideo(),Utils.isLegacyIE()&&$("input, textarea").placeholder(),Utils.mailchimp(),Utils.campaign()},isLegacyIE:function(){return Utils.$html.hasClass("ie8")||Utils.$html.hasClass("ie9")},isMobile:function(){var e=navigator.userAgent,t=/Android|iPhone|iPad|PlayBook|Mobile|IEMobile/i;return t.test(e)},isHome:function(){return Utils.$body.hasClass("home")},removeBgVideo:function(){Utils.isMobile()&&$(".bg-video").remove()},lightbox:function(e,t){var i=Utils.$lb.find(".wrap"),n=Utils.$lb.find(".content");"on"===e?(n.empty(),n.html(t),Utils.$lb.addClass("open"),i.on("click.lbOpen",function(){Utils.$body.hasClass("nav-open")&&Utils.$mh.find(".menu-btn").trigger("click")})):(n.empty(),Utils.$lb.removeClass("open"),i.off("click.lbOpen"))},mailchimp:function(){var e=$(".signup-form, .subscribe-module"),t="http://restorenyc.us13.list-manage.com/subscribe?u=3ab98ba41ef52e8a3ed2e0745&id=5360afa171&MERGE0=";e.length&&e.each(function(){var e=$(this),i=e.find(".email-submit");i.click(function(i){i.preventDefault(),window.location.href=t+e.find(".email").val()})})},campaign:function(){function e(e){return e.indexOf("?")>-1?"&":"?"}var t=$(".campaign-support, .donate-module");t.length&&t.each(function(){var t=$(this).find(".donate-action"),i=t.attr("href"),n=$(this).find(".donate-amount"),o=$(this).find(".monthly"),a=o.find("input"),l=$(this).find(".check strong"),s=$(this).find(".check-address"),r=null;o.on("click",function(e){"0"===a.val()?(a.val("1"),o.find(".checkbox-off").removeClass("show"),o.find(".checkbox-on").addClass("show")):(a.val("0"),o.find(".checkbox-off").addClass("show"),o.find(".checkbox-on").removeClass("show")),n.trigger("keyup")}),n.on("keyup",function(l){l.preventDefault(),r=i+e(i)+"amount="+n.val(),o.length&&(r=r+e(r)+"recurring="+a.val()),t.attr("href",r)}),l.on("click",function(){s.toggleClass("show")}),n.trigger("keyup")})},cookie:function(e,t,i){if(arguments.length<2){for(var n=document.cookie.split(";"),o=0;o<n.length;o++){var a=n[o].replace(/^\s+/,"");if(0==a.indexOf(e+"="))return decodeURIComponent(a.substring(e.length+1).split("+").join(" "))}return null}var l=new Date;l.setTime(l.getTime()+i),document.cookie=e+"="+encodeURIComponent(t)+(i?";expires="+l.toGMTString():"")+";path=/"}}}(jQuery);!function(e){var t={trackOpen:!0,init:function(){this.loadAnnouncement(),this.bindEvents()},closeNav:function(){Utils.lightbox("off"),this.closeSubmenu(),Utils.$body.removeClass("nav-open")},closeSubmenu:function(){Utils.$nav.find(".item.open").removeClass("open")},loadAnnouncement:function(){var t="showAnnouncement",i=e(".announcement-bar");i.length>0&&(Utils.$body.on("click",".announcement-bar .close",function(e){e.stopPropagation(),i.removeClass("show"),Utils.cookie(t,"false",864e5)}),"false"===Utils.cookie(t)?i.removeClass("show"):i.addClass("show"))},bindEvents:function(){var i=this;Utils.$body.on("click",".menu-btn, .menu-close",function(t){Utils.$body.hasClass("nav-open")?i.closeNav():(Utils.lightbox("on"),Utils.$body.addClass("nav-open"),e(window).on("resize.nav",window,function(t){this.outerWidth>1024&&(i.closeNav(),e(window).off("resize.nav"))}))}).on("click","#site-nav .close",function(e){Utils.lightbox("off"),Utils.$body.removeClass("nav-open")}).on("click","#site-nav .has-sub",function(i){var n=e(i.target).closest(".item");n.parent(".subitem").length<1&&(n.hasClass("open")?t.closeSubmenu():(t.closeSubmenu(),n.addClass("open")))})}};e(document).ready(function(){t.init()})}(jQuery),function(e){var t={el:null,init:function(){this.el=e(".single-header"),this.loadHeaderImage(),this.loadVideo()},loadHeaderImage:function(){if(this.el.length>0&&(Utils.isHome()||this.el.hasClass("bg-image")||this.el.hasClass("bg-image-blog"))){var t=this.el.find(".portrait");url=t.attr("data-img-url"),position=""===e.trim(t.attr("data-img-pos"))?"50% 50%":t.attr("data-img-pos"),img=new Image,img.addEventListener("load",function(){t.css({"background-image":"url("+url+")","background-position":position}).addClass("loaded").closest("section").addClass("ready")}),img.src=url}},loadVideo:function(){var t,i,n=e(".single-header"),o=n.find("video");!Utils.isLegacyIE()&&!Utils.isMobile()&&n.length>0&&o.length>0?(i=o.attr("data-src"),t=i.substr(i.lastIndexOf(".")+1),o.on("loadstart",function(){o.addClass("loaded")}),o.attr("src",i)):n.addClass("no-video")}};e(document).ready(function(){t.init()})}(jQuery),function(e){var t={el:null,init:function(){this.el=e("#hero"),this.el.length>0&&(this.loadHeaderImage(),this.loadVideo(),this.bindClickEvents())},isMobileVP:function(){return this.getViewport().width<1024},loadHeaderImage:function(){if(this.el.length>0&&this.el.hasClass("hero-bg-image")){var t=this.el.find(".portrait");url=t.attr("data-img-url"),position=""===e.trim(t.attr("data-img-pos"))?"50% 50%":t.attr("data-img-pos"),img=new Image,img.addEventListener("load",function(){t.css({"background-image":"url("+url+")","background-position":position}).addClass("loaded").closest("section").addClass("ready")}),img.src=url}},loadVideo:function(){var t,i,n=e("#hero"),o=n.find("video");!Utils.isLegacyIE()&&!Utils.isMobile()&&n.length>0&&o.length>0?(i=o.attr("data-src"),t=i.substr(i.lastIndexOf(".")+1),o.on("loadstart",function(){o.addClass("loaded")}),o.attr("src",i)):n.addClass("no-video")},getViewport:function(){var e=window,t="inner";return"innerWidth"in window||(t="client",e=document.documentElement||document.body),{width:e[t+"Width"],height:e[t+"Height"]}},fixPosition:function(){var t=(this.getViewport().width,this.getViewport().height);this.isMobileVP()?(e("#hero").css("margin-bottom",0),Utils.$main.css("opacity",1),Utils.$main.removeClass("locked")):(Utils.$main.addClass("locked"),e("#hero").css("margin-bottom",t))},bindEvents:function(){e(window).on("scroll",function(){var t=this.getViewport().height,i=Utils.$main.height(),n=window.scrollY,o=n/t,a=o<.35?.35:o<1?o:1;this.isMobileVP()||(n>t-5?(Utils.$main.css("opacity",1),e("#hero").css("margin-bottom",0),Utils.$main.removeClass("locked")):(Utils.$main.css("opacity",a),e("#hero").css("margin-bottom",t+i),Utils.$main.addClass("locked")))}.bind(this)),e(window).on("resize",function(){this.fixPosition(),e("html, body").scrollTop(0)}.bind(this))},bindClickEvents:function(){e(".nav-down").click(function(){var t=Utils.$mh,i=t.height();return e("html, body").animate({scrollTop:this.getViewport().height-i},600),!1}.bind(this))}};e(document).ready(function(){t.init()})}(jQuery);var Billboard=function(e){return e(function(){Billboard.init()}),{time:3,limit:12,timers:[],isWrapped:!0,vimeo:{regex:"vimeo.com/video/",baseUrl:"https://player.vimeo.com/video/",queryVar:"?badge=0&title=0&byline=0&rel=0&autoplay=1",attr:{frameborder:"0",webkitallowfullscreen:"true",mozallowfullscreen:"true",allowfullscreen:"true"}},youtube:{regex:"youtu.be/",baseUrl:"https://www.youtube.com/embed/",queryVar:"?autoplay=1",attr:{frameborder:"0",allowfullscreen:"true"}},init:function(){this.collection=Utils.$body.find(".billboard"),this.collection.length&&this.bindEvents()},addVideo:function(e){var t;return e.indexOf(this.vimeo.regex)>-1?(t=e.split(this.vimeo.regex)[1],this.createIframe("vimeo",t)):e.indexOf(this.youtube.regex)>-1?(t=e.split(this.youtube.regex)[1],this.createIframe("youtube",t)):void 0},createIframe:function(t,i){var n=e("<iframe></iframe>").clone(),o=this[t],a=o.baseUrl+i+o.queryVar;return n.attr("src",a),e.each(o.attr,function(e,t){n.attr(e,t)}),n},startTimer:function(e){var t=this,i=1;this.timers[e]=setInterval(function(){i<t.limit?(t.collection.eq(e).find(".slider-billboard").flickity("next",t.isWrapped),i++):t.stopTimer(e)},1e3*this.time)},stopTimer:function(e){clearInterval(this.timers[e])},bindEvents:function(){var t=this;this.collection.each(function(i,n){function o(){d.filter(".is-selected").removeClass("is-selected"),d.eq(r.selectedIndex).addClass("is-selected"),a()}function a(){var e=c.find("ul"),t=d.filter(".is-selected"),i=(t.width(),t.position().left),n=(.5*window.screen.width,e.scrollLeft()),o=n>i?i+n:i;e.animate({scrollLeft:o},1e3)}var l=e(n).find(".gallery-cell"),s=e(n).find(".slider-billboard").flickity({pageDots:!1,wrapAround:!0}),r=s.data("flickity"),c=e(n).find("nav"),d=c.find("li");s.on("cellSelect",function(){o()}),s.on("click.timer",".flickity-prev-next-button",function(){t.stopTimer(i),s.off("click.timer")}),s.on("staticClick.timer, dragStart.timer",function(){t.stopTimer(i),s.off("staticClick.timer, dragStart.timer")}),c.on("click","li",function(){var n=e(this).index();s.flickity("select",n),t.stopTimer(i)}),o(),l.length>1&&(l.each(function(i,n){var o=e(n).attr("data-video");if(o&&""!==o){var a=t.addVideo(o);e(n).addClass("video").on("click",".image-wrap",function(){e(n).addClass("play"),e(n).find(".video-wrap").html(a)})}}),t.startTimer(i))})}}}(jQuery);!function(e){var t={init:function(){this.collapsed()},collapsed:function(){var t=Utils.$body.find(".collapsed");t.length>0&&t.find(".mask .btn").click(function(t){e(t.target).closest(".collapsed").addClass("show")})}};e(document).ready(function(){t.init()})}(jQuery);var Video=function(e){return e(function(){Video.init()}),{vimeo:{regex:"vimeo.com/video/",baseUrl:"https://player.vimeo.com/video/",queryVar:"?badge=0&title=0&byline=0&rel=0&autoplay=1",attr:{frameborder:"0",webkitallowfullscreen:"true",mozallowfullscreen:"true",allowfullscreen:"true"}},youtube:{regex:"youtu.be/",baseUrl:"https://www.youtube.com/embed/",queryVar:"?autoplay=1",attr:{frameborder:"0",allowfullscreen:"true"}},init:function(){this.videoSections=Utils.$body.find(".sec-video"),this.videoSections.length&&this.bindEvents()},addVideo:function(e){var t;return e.indexOf(this.vimeo.regex)>-1?(t=e.split(this.vimeo.regex)[1],this.createIframe("vimeo",t)):e.indexOf(this.youtube.regex)>-1?(t=e.split(this.youtube.regex)[1],this.createIframe("youtube",t)):void 0},createIframe:function(t,i){var n=e("<iframe></iframe>").clone(),o=this[t],a=o.baseUrl+i+o.queryVar;return n.attr("src",a),e.each(o.attr,function(e,t){n.attr(e,t)}),n},bindEvents:function(){this.videoSections.each(function(t,i){var n=e(i).attr("data-video");n&&""!==n&&e(i).on("click",".image-wrap",function(){if(window.lity){lity(n)}})})}}}(jQuery);